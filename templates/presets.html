{% extends "base.html" %}
{% block content %}
<h1>Manage Recurring Budget Presets</h1>

<p>These presets will be automatically applied when creating budgets for new months.</p>

<h2>Current Presets</h2>
{% if presets %}
<table>
  <thead>
    <tr>
      <th>Category</th>
      <th>Subcategory</th>
      <th>Amount</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for cat, subs in presets.items() %}
      {% for sub, amt in subs.items() %}
      <tr>
        <td>{{ cat }}</td>
        <td>{{ sub }}</td>
        <td>${{ "%.2f"|format(amt) }}</td>
        <td>
          <form method="post" action="{{ url_for('remove_preset') }}" style="display: inline;">
            <input type="hidden" name="category" value="{{ cat }}">
            <input type="hidden" name="subcategory" value="{{ sub }}">
            <button type="submit" class="chip chip-action" onclick="return confirm('Remove this preset?')">Remove</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No presets defined yet.</p>
{% endif %}

<h2>Add New Preset</h2>
<form method="post" action="{{ url_for('add_preset') }}">
  <div class="input-field">
    <select name="category" id="category" required>
      <option value="" disabled selected>Choose category</option>
      <option value="Shopping">Shopping</option>
      <option value="Utilities">Utilities</option>
      <option value="Home">Home</option>
      <option value="Earnings">Earnings</option>
    </select>
    <label for="category">Category</label>
  </div>
  <div class="input-field">
    <input id="subcategory" name="subcategory" type="text" required>
    <label for="subcategory">Subcategory</label>
  </div>
  <div class="input-field">
    <input id="amount" name="amount" type="number" step="0.01" required>
    <label for="amount">Default Amount</label>
  </div>
  <button type="submit" class="chip chip-action">Add Preset</button>
</form>
<script>
  // Initialize Materialize select
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    M.FormSelect.init(elems);
  });
</script>

<div style="margin-top:2em;">
  <a href="{{ url_for('index') }}" class="chip chip-action">Back to Home</a>
</div>
{% endblock %}
